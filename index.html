<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Costos de Impresión</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="manifest" href="manifest.json">
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js');
        }
    </script>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">Calculadora de Costos de Impresión</h1>
        <p class="text-center">Agrega medidas en cm (ej: 1x2, 1.00x2.00 o 1,00x2,00), calcula m² totales y costos.</p>

        <!-- Formulario para agregar medidas -->
        <div class="card mb-4">
            <div class="card-header">Agregar Medidas</div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <label for="ancho" class="form-label">Ancho (cm)</label>
                        <input type="number" class="form-control" id="ancho" step="0.01" placeholder="Ej: 1, 1.00 o 1,00">
                    </div>
                    <div class="col-md-4">
                        <label for="alto" class="form-label">Alto (cm)</label>
                        <input type="number" class="form-control" id="alto" step="0.01" placeholder="Ej: 2, 2.00 o 2,00">
                    </div>
                    <div class="col-md-4 d-flex align-items-end">
                        <button class="btn btn-primary" onclick="agregarMedida()">Agregar Medida</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Lista de medidas -->
        <div class="card mb-4">
            <div class="card-header">Medidas Agregadas</div>
            <div class="card-body">
                <ul id="listaMedidas" class="list-group"></ul>
                <p id="totalM2" class="mt-3 fw-bold">Total m²: 0.00</p>
            </div>
        </div>

        <!-- Formulario de costos -->
        <div class="card mb-4">
            <div class="card-header">Costos</div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3">
                        <label for="precioM2" class="form-label">Precio por m² (material)</label>
                        <input type="number" class="form-control" id="precioM2" step="0.01" placeholder="Ej: 6.00">
                    </div>
                    <div class="col-md-3">
                        <label for="costoDiseno" class="form-label">Costo Diseño</label>
                        <input type="number" class="form-control" id="costoDiseno" step="0.01" placeholder="Ej: 5.00">
                    </div>
                    <div class="col-md-3">
                        <label for="costoPasaje" class="form-label">Costo Pasaje y Comida</label>
                        <input type="number" class="form-control" id="costoPasaje" step="0.01" placeholder="Ej: 4.00">
                    </div>
                    <div class="col-md-3 d-flex align-items-end">
                        <button class="btn btn-success" onclick="calcularTotal()">Calcular Total</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Resultado -->
        <div class="card">
            <div class="card-header">Total a Cobrar</div>
            <div class="card-body">
                <h2 id="totalCosto" class="text-success">$0.00</h2>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let medidas = [];
        let totalM2 = 0;

        function agregarMedida() {
            // Reemplaza comas por puntos para aceptar formatos como 1,00 o 1.00
            const ancho = parseFloat(document.getElementById('ancho').value.replace(',', '.'));
            const alto = parseFloat(document.getElementById('alto').value.replace(',', '.'));
            if (isNaN(ancho) || isNaN(alto) || ancho <= 0 || alto <= 0) {
                alert('Ingresa valores válidos para ancho y alto.');
                return;
            }
            const m2 = (ancho / 100) * (alto / 100);
            medidas.push({ ancho, alto, m2 });
            totalM2 += m2;
            actualizarLista();
            document.getElementById('ancho').value = '';
            document.getElementById('alto').value = '';
        }

        function actualizarLista() {
            const lista = document.getElementById('listaMedidas');
            lista.innerHTML = '';
            medidas.forEach((medida, index) => {
                const li = document.createElement('li');
                li.className = 'list-group-item d-flex justify-content-between align-items-center';
                li.innerHTML = `${medida.ancho}cm x ${medida.alto}cm = ${medida.m2.toFixed(2)} m² 
                    <button class="btn btn-danger btn-sm" onclick="eliminarMedida(${index})">Eliminar</button>`;
                lista.appendChild(li);
            });
            document.getElementById('totalM2').textContent = `Total m²: ${totalM2.toFixed(2)}`;
        }

        function eliminarMedida(index) {
            totalM2 -= medidas[index].m2;
            medidas.splice(index, 1);
            actualizarLista();
        }

        function calcularTotal() {
            const precioM2 = parseFloat(document.getElementById('precioM2').value.replace(',', '.')) || 0;
            const costoDiseno = parseFloat(document.getElementById('costoDiseno').value.replace(',', '.')) || 0;
            const costoPasaje = parseFloat(document.getElementById('costoPasaje').value.replace(',', '.')) || 0;
            const costoMaterial = totalM2 * precioM2;
            const total = costoMaterial + costoDiseno + costoPasaje;
            document.getElementById('totalCosto').textContent = `$${total.toFixed(2)}`;
        }
    </script>
</body>
</html>
